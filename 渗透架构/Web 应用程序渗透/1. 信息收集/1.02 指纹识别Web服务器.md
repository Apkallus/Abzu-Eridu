## 指纹识别Web服务器

### 摘要

Web 服务器指纹识别是指识别目标正在运行的服务器类型和版本的任务。虽然 Web 服务器指纹识别通常包含在自动化测试工具中，但了解工具如何尝试识别软件的基本原理很重要。

准确发现应用程序正在运行的服务器类型可确定该应用程序是否容易受到攻击。特别是，运行没有最新安全补丁的旧版本软件的服务器可能容易受到已知的版本特定漏洞攻击。

### 目标

确定正在运行的服务器的版本和类型，以进一步发现任何已知漏洞。

### 方法

用于 Web 服务器指纹识别的技术包括横幅抓取、诱导对畸形请求的响应，以及使用自动化工具执行使用组合策略的更强大的扫描。所有这些技术运作的基本前提都是相同的。它们都努力从web服务器中获取一些响应，然后将这些响应与已知响应和行为的数据库进行比较，从而与已知的服务器类型相匹配。

#### 横幅抓取

横幅抓取是通过向 Web 服务器发送 HTTP 请求并检查其响应头来完成的。这可以使用各种工具来实现，包括用于 HTTP 请求的 ```telnet```，或用于通过 TLS/SSL 发送请求的 ```openssl```。

:x: 各类服务器响应的示例 :x:

注重安全的应用程序可能会通过修改响应头来混淆其服务器信息。此时，可根据响应头字段的顺序猜测服务器的类型。然而，考虑到许多不同的 Web 服务器可能使用相同的字段顺序，并且字段可以被修改或删除，这种方法并不确定。

#### 发送畸形请求

Web服务器或可通过检查其错误响应来识别，如果没有自定义，则可以检查其默认错误页面。迫使服务器呈现这些内容的一种方法是故意发送错误或格式不正确的请求。

由于默认错误页提供了不同类型web服务器的许多区分因素，因此即使在服务器头字段被混淆的情况下，也可能是一种有效的指纹识别方法。

[Default 404 Pages](https://0xdf.gitlab.io/cheatsheets/404)，提供了各种服务器的默认错误页面

#### 使用自动扫描工具

拥有 web 服务器指纹识别的自动扫描工具，能够发出类似于上面演示的请求，以及发送其他更特定于服务器的探针。并利用已知响应的大型数据库来尝试识别服务器

包含web服务器指纹识别功能的常用的扫描工具：
- [Netcraft](https://toolbar.netcraft.com/site_report), 扫描网站信息的在线工具，包括web服务器的详细信息。
- [Nikto](https://github.com/sullo/nikto), 开源的命令行扫描工具。
- [Nmap](https://nmap.org/), 开源的命令行工具，也有一个GUI  [Zenmap](https://nmap.org/zenmap/).

### 修复

- 在headers中隐藏web服务器信息，例如使用Apache的 [mod_headers module](https://httpd.apache.org/docs/current/mod/mod_headers.html).
- 使用加固的 [反向代理服务器](https://en.wikipedia.org/wiki/Proxy_server#Reverse_proxies) 在web服务器和互联网之间创建额外的安全层。
- 确保web服务器使用最新的软件和安全补丁。

## 引用
- [WSTG-INFO-02](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/01-Information_Gathering/02-Fingerprint_Web_Server.md)