# 映射应用程序执行路径

## 摘要
在开始安全测试之前，理解应用程序的结构至关重要。如果不透彻了解应用程序的布局，则不太可能进行全面的测试。

## 测试目标
- 映射目标应用程序并理解其主要工作流程。

## 测试方法

在黑盒测试中，测试整个代码库是极其困难的。这不仅因为测试人员无法看到应用程序中的代码路径，还因为测试所有代码路径将非常耗时。解决这个问题的一种方法是记录已发现和测试过的代码路径。

有几种方法可测试与度量代码覆盖率：

-   **路径** - 测试应用程序中的每条路径，包括对每个决策路径进行组合和边界值分析测试。虽然这种方法很彻底，但可测试路径的数量会随着每个决策分支呈指数级增长。
-   **数据流（或污点分析）** - 测试通过外部交互（通常是用户）进行的变量赋值。重点在于映射数据在整个应用程序中的流动、转换和使用。
-   **竞态** - 测试操作同一数据的多个并发应用程序实例。

方法的选择以及每种方法的使用程度应与应用程序所有者协商。此外，也可以采用更简单的方法。例如，测试人员可以向应用程序所有者询问他们特别关注的特定功能或代码部分，并讨论如何到达这些代码段。

为了向应用程序所有者展示代码覆盖率，测试人员可以首先在电子表格中记录通过爬取应用程序（手动或自动）发现的所有链接。然后，测试人员可以更仔细地查看应用程序中的决策点，并调查发现了多少重要的代码路径。这些路径应随后在电子表格中记录，包括URL、描述性文字以及所发现路径的屏幕截图说明。

### 自动爬取

自动爬虫是一种用于自动发现特定站点上新资源（URL）的工具。它从一个要访问的URL列表（称为种子）开始，这取决于爬虫的启动方式。虽然有很多爬虫工具，但以下示例使用 [Zed Attack Proxy (ZAP)](https://github.com/zaproxy/zaproxy)：

![Zed Attack Proxy 屏幕](images/Zed%20Attack%20Proxy%20Screen.png)\
*图 WSTG：Zed Attack Proxy Screen*

[ZAP](https://github.com/zaproxy/zaproxy) 提供各种自动爬取选项，测试人员可以根据需求使用：

- [Spider](https://www.zaproxy.org/docs/desktop/start/features/spider/)
- [Ajax Spider](https://www.zaproxy.org/docs/desktop/addons/ajax-spider/)
- [OpenAPI Support](https://www.zaproxy.org/docs/desktop/addons/openapi-support/)

## 工具

-   [Zed Attack Proxy (ZAP)](https://github.com/zaproxy/zaproxy)
-   [电子表格软件列表](https://en.wikipedia.org/wiki/List_of_spreadsheet_software)
-   [图表绘制软件](https://en.wikipedia.org/wiki/List_of_concept-_and_mind-mapping_software)

## 参考资料

- [WSTG-INFO-07](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/01-Information_Gathering/07-Map_Execution_Paths_Through_Application.md)
-   [代码覆盖率](https://en.wikipedia.org/wiki/Code_coverage)
