
## 利用搜索引擎侦测信息泄露

### 摘要

搜索引擎依赖爬虫程序定期从网络页面中爬取数据。爬虫程序通过页面中的链接或站点地图来发现网页。当站点使用特殊文件 ```robots.txt``` 列出不希望被搜索引擎抓取的页面，那么列出的页面可能被忽略。

使用搜索引擎对网站和 Web 应用程序进行侦察。侦察分为直接与间接：直接方法与搜索索引和相关缓存的内容有关，而间接方法与搜索论坛、新闻组和招标网站来获取敏感的设计和配置信息有关。

爬虫完成爬取后，将根据标签和相关属性（如 ```<TITLE>```）开始索引网页内容，以返回相关的搜索结果。当网站在运行期间未更新 ```robots.txt``` 文件，并且未使用指示机器人不索引内容的内联 HTML 元标签，则索引中可能包含网站所有者不希望暴露的网页内容。网站所有者可使用 ```robots.txt``` 、HTML 元标签、身份验证以及搜索引擎提供的工具来删除此类内容。

### 目标

- 识别应用程序、系统或组织的敏感设计与配置信息，是否直接在组织网站上或间接通过第三方的暴露。

### 方法

使用搜索引擎搜索潜在的敏感信息：
- 网络拓扑图与配置
- 管理员等关键员工的存档帖子或电子邮件
- 第三方或云服务配置文件
- 泄露的错误信息内容
- 泄露的非公开应用程序（开发、测试、用户验收测试、预发布版本）

#### 搜索引擎

- [百度](https://www.baidu.com/)
- [Bing](https://www.bing.com/)
- [binsearch.info](https://binsearch.info/)，二进制 Usenet 新闻组搜索
- [Common Crawl](https://commoncrawl.org/)，网页爬取静态快照的开放数据库
- [DuckDuckGo](https://duckduckgo.com/)，整合搜索
- [Google](https://www.google.com/)
- [Internet Archive Wayback Machine](https://archive.org/web/)，互联网档案库
- [Shodan](https://www.shodan.io/)，互联网设备与服务搜索

#### 搜索运算符
搜索运算符通常以 ```operator:query``` 的形式，应用查询关键字对搜索结果进行限制
- ```site:``` 对域名的限制
- ```inurl:``` 对 URL 的限制
- ```intitle:``` 对页面标题的限制
- ```intext:``` 或 ```inbody:``` 对页面正文的限制
- ```filetype:``` 对文件类型的限制

##### Internet Archive Wayback Machine
互联网档案库保存着网页历史存档

查看网站的存档版本，访问 ```https://web.archive.org/web/*/``` 后跟目标网址：
```
https://web.archive.org/web/*/example.org
```

##### 其他缓存内容服务

- [archive.ph](https://archive.ph/)，按需归档，创建永久快照
- [CachedView](https://cachedview.com/)，聚合缓存

#### 搜索引擎黑客

串联使用操作符，以有效发现特定类型的敏感文件和信息。

[Google Hacking Database](https://www.exploit-db.com/google-hacking-database)，使用搜索运算符构成的关键词的数据库

### 修复

在将设计和配置信息发布到网上之前考虑其敏感性，并对此定期审查。

## 引用
- [WSTG-INFO-01](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/01-Information_Gathering/01-Conduct_Search_Engine_Discovery_Reconnaissance_for_Information_Leakage.md)