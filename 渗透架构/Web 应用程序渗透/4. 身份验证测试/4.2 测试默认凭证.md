# 测试默认凭证

## 概述

许多Web应用程序和硬件设备的内置管理员账户都设有默认密码。尽管某些情况下这些密码可能是随机生成的，但它们通常是静态的，这意味着攻击者可以轻松猜测或获取这些密码。

此外，当应用程序中创建新用户时，这些账户可能会被设置预定义的密码。这些密码可能由应用程序自动生成，或由工作人员手动创建。无论哪种情况，如果密码生成方式不安全，攻击者就有可能猜出这些密码。

## 测试目标

- 确定应用程序是否存在使用默认密码的用户账户。
- 检查新创建的用户账户是否使用了弱密码或易被猜解的密码。

## 测试方法

### 供应商默认凭据测试

识别默认密码的第一步是确认正在使用的软件类型，本指南的[信息收集](../1.%20信息收集/)章节已对此进行详细说明。

确认软件后，尝试查找其是否使用默认密码及具体内容，方法包括：

- 搜索 “[软件名]默认密码”
- 查阅手册或厂商文档
- 检查常用默认密码数据库，例如：[CIRT.net](https://cirt.net/passwords)、[SecLists默认密码库](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials)或[DefaultCreds-cheat-sheet](https://github.com/ihebski/DefaultCreds-cheat-sheet/blob/main/DefaultCreds-Cheat-Sheet.csv)
- 检查应用程序源代码（如果可获取）
- 在虚拟机中安装应用程序并进行分析
- 检查物理设备上的标签（常见于网络设备）

若未找到默认密码，可尝试以下常见选项：

- "admin"、"password"、"12345"等[常见默认密码](https://github.com/nixawk/fuzzdb/blob/master/bruteforce/passwds/default_devices_users%2Bpasswords.txt)
- 空密码或留空
- 设备序列号或MAC地址

若用户名未知，可参考[WSTG 账户枚举测试](../03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account.md)中的多种用户枚举方法，或尝试"admin"、"root"、"system"等常见用户名。

### 组织默认密码测试

当组织内部员工为新账户手动创建密码时，可能会采用可预测的方式。常见模式包括：

- 单一通用密码，例如"Password1"
- 组织特定信息，如组织名称或地址
- 遵循简单规律的密码，例如周一创建的账户使用"Monday123"

这类密码在黑盒测试中通常难以识别，除非能成功猜解或暴力破解。但在进行灰盒或白盒测试时则容易发现。

### 应用程序生成默认密码测试

若应用程序自动为新用户账户生成密码，这些密码也可能存在可预测性。测试方法为：同时使用相似信息创建多个账户，对比系统分配的密码。

密码生成机制可能基于：

- 账户间共享的静态字符串
- 账户信息的哈希或混淆值（如`md5($用户名)`)
- 时间戳算法
- 弱伪随机数生成器（PRNG）

此类问题在黑盒测试视角下通常难以识别。

## Tools

- [Burp Intruder](https://portswigger.net/burp/documentation/desktop/tools/intruder)
- [THC Hydra](https://github.com/vanhauser-thc/thc-hydra)
- [Nikto 2](https://www.cirt.net/nikto2)
- [Nuclei](https://github.com/projectdiscovery/nuclei)
    - [Default Login - Nuclei Templates](https://github.com/projectdiscovery/nuclei-templates/tree/6b26c63d8f63b2a812a478f14c4c098b485d54b4/http/default-logins)

## References

- [WSTG-ATHN-02](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/04-Authentication_Testing/02-Testing_for_Default_Credentials.md)
- [CIRT](https://cirt.net/passwords)
- [SecLists Default Passwords](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials)
- [DefaultCreds-cheat-sheet](https://github.com/ihebski/DefaultCreds-cheat-sheet/blob/main/DefaultCreds-Cheat-Sheet.csv)