# 测试弱身份验证方法

## 概述

最普遍且最易实施的身份验证机制是静态密码。密码如同王国的钥匙，但常因用户追求便利性而被削弱。在近期多次曝光用户凭证的高知名度黑客事件中，令人遗憾的是最常用密码仍是：`123456`、`password` 和 `qwerty`。

此外，应用程序可能使用替代凭证（如生日、社保号码、PIN码或安全问题），这些凭证虽被视同密码处理，但其安全性远弱于传统密码。在某些场景下，这些更易被猜到的凭证可能成为身份验证中唯一由用户提供的凭据。

## 测试目标

- 通过评估密码的长度、复杂性、复用性和时效性要求，确定应用程序抵抗使用现有密码字典进行暴力破解的能力。

## 测试方法

1. 密码允许和禁止使用哪些字符？是否要求用户使用不同字符集的字符（如大小写字母、数字和特殊符号）？
2. 用户可更改密码的频率是多少？上次更改后多久可再次修改？用户可能通过连续修改5次密码来绕过密码历史记录要求，从而在最后一次修改后重新设置初始密码。
3. 用户必须在何时更改密码？
    - 尽管PCI DSS等标准可能要求定期强制修改密码，但[NIST](https://pages.nist.gov/800-63-3/sp800-63b.html#memsecretver)和[NCSC](https://www.ncsc.gov.uk/collection/passwords/updating-your-approach#PasswordGuidance:UpdatingYourApproach-Don'tenforceregularpasswordexpiry)均**不建议**强制定期密码过期。
4. 密码可重复使用的频率是多少？应用程序是否保存用户最近使用过的8个密码历史记录？
5. 新密码必须与旧密码有多大差异？
6. 是否禁止用户在密码中使用用户名或其他账户信息（如姓氏或名字）？
7. 可设置的最小和最大密码长度是多少？这些长度是否适合该账户和应用程序的敏感度？
8. 是否允许设置常见密码（如`Password1`或`123456`）？
9. 密码是否由应用程序为用户指定（如社保号码或生日）？替代标准密码使用的凭据是否容易获取、可预测或易受暴力破解攻击？

## 修复措施

为降低因密码易被猜解导致未授权访问的风险，有两种解决方案：引入额外的认证控制（如双因素认证）或实施强密码策略。其中最简单且成本最低的方法是推行强密码策略，确保密码具备足够的长度、复杂性、禁用重复使用并设置有效期；理想情况下应同时实施这两种方案。

## 参考资料

- [WSTG-ATHN-07](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/04-Authentication_Testing/07-Testing_for_Weak_Authentication_Methods.md)
- [OWASP 暴力破解攻击](https://owasp.org/www-community/attacks/Brute_force_attack)
