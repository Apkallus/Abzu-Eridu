# 报告撰写

执行评估的技术工作只是整个评估过程的一半。最终成果是生成一份撰写精良、信息丰富的报告。报告应易于理解，并突出评估阶段发现的所有风险。

## 关于本部分

本指南仅针对一种可能的报告撰写方法提供建议，不应被视为必须严格遵守的规则。在考虑以下任何建议时，请始终自问该建议是否能改进您的报告。

本报告撰写指南最适用于咨询类报告。对于内部报告或漏洞赏金报告而言，其内容可能过于详尽。

无论受众是谁，都建议对报告进行安全保护并加密，以确保只有接收方能够使用。

一份优秀的报告能帮助客户理解您的发现，并彰显您技术测试的质量。如果客户无法理解您的发现，那么技术测试的质量将毫无意义。

## 1. 引言

### 1.1 版本控制

记录报告变更，通常以如下表格形式呈现：

| 版本 | 描述 | 日期 | 作者 |
|:----:|------|------|------|
| 1.0 | 初始报告 | DD/MM/YYYY | J. Doe |

### 1.2 目录

文档的目录页。

### 1.3 团队成员

列出团队成员详细信息，包括其专业领域和资质。

### 1.4 范围

与组织商定的合作边界和需求范围。

### 1.5 限制条件

可能存在的限制条件包括：

- 超出测试范围的区域
- 功能异常
- 缺乏合作配合
- 时间不足
- 访问权限或凭证缺失

### 1.6 时间线

本次合作的持续时间。

### 1.7 免责声明

您可能需要为服务提供免责声明。请务必咨询法律专业人士以创建具有法律约束力的文件。

以下示例仅用于说明目的，不应直接使用，也不构成法律建议。

*本次测试为"时间点"评估，因此自测试运行以来环境可能已发生变化。无法保证已识别所有可能存在的安全问题，且测试运行后可能已发现新的漏洞。因此，本报告仅作为指导性文件，不能保证报告全面反映了当前系统面临的风险。*

## 2. 执行摘要

本节类似于报告的"电梯演讲"，旨在向管理层提供以下信息：

- **测试目标**
    - 描述安全测试背后的业务需求
    - 说明测试如何帮助组织理解其系统状况
- **业务背景下的关键发现**
    - 重点关注合规性问题、声誉损害等业务影响，暂不涉及技术细节
- **战略建议**
    - 以非技术性语言说明企业如何防止问题再次发生，暂不提供具体技术方案

执行摘要应具有建设性和实际意义，避免使用专业术语和负面推测。若使用图表或插图，需确保其能比文字更清晰地传递信息。

## 3. 发现项

本节面向技术团队，应包含理解漏洞、复现漏洞和解决漏洞所需的所有信息。逻辑划分有助于提升报告的可读性，例如可设置"外部访问"和"内部访问"独立章节。

若为复测报告，可创建子章节汇总既往测试发现、已识别漏洞的更新状态，以及与当前测试的交叉引用。

### 3.1 发现项摘要

按风险等级列出的发现项清单。使用表格便于技术和管理团队共同查阅。

| 参考ID | 标题 | 风险等级 |
|:------------:|------|----------|
| 1 | 用户身份验证绕过 | 高 |

### 3.2 发现项详情

每个发现项应包含以下详细信息：

- **参考ID**：用于双方沟通和报告内的交叉引用
- **漏洞标题**：例如"用户身份验证绕过"
- **问题可能性/可利用性**：基于以下因素评估
    - 漏洞利用难度
    - 是否存在可用的漏洞利用代码
    - 所需访问权限级别
    - 攻击者的利用动机
- **漏洞对系统的影响**
- **漏洞对应用的风险等级**
    - 建议等级包括：信息类、低、中、高、严重。需在附录中详细说明评分标准
    - 特定项目可能要求提供[CVSS](https://www.first.org/cvss/)评分。非强制要求时，可根据情况决定是否添加，避免过度增加报告复杂度
- **漏洞详细描述**：包括漏洞本质、利用方法及可能造成的损害。涉及密码、个人信息、银行卡详情等敏感数据需进行脱敏处理
- **修复措施**：详细说明漏洞修复步骤、可提升安全态势的改进建议以及缺失的安全实践
- **补充资源**：帮助读者理解漏洞的辅助材料，如图片、视频、CVE编号、外部指南等

本节的排版格式应以最佳方式传递信息为原则。

确保描述内容为工程师提供足够的可操作信息，全面解释发现项并提供修复所需的技术细节。

## 附录

可添加多个附录，例如：
- 使用的测试方法
- 严重性和风险等级说明
- 相关工具输出结果
    - 确保清理输出内容，避免直接堆砌原始数据
- 所有测试的检查清单，例如[WSTG检查清单](https://github.com/OWASP/wstg/tree/master/checklists)。这些可作为报告附件提供

## 参考文献

（本部分不属于建议的报告格式）以下链接为报告撰写提供更多指导：
- [WSTG 5-Reporting 01-Reporting_Structure](https://github.com/OWASP/wstg/blob/master/document/5-Reporting/01-Reporting_Structure.md)
- [SANS：创建强有力的网络安全评估报告技巧](https://www.sans.org/blog/tips-for-creating-a-strong-cybersecurity-assessment-report/)
- [SANS：渗透测试报告撰写指南](https://www.sans.org/reading-room/whitepapers/bestprac/paper/33343)
- [Infosec Institute：渗透测试报告撰写艺术](https://resources.infosecinstitute.com/topic/writing-penetration-testing-reports/)
- [Dummies：如何构建渗透测试报告](https://www.dummies.com/computers/macs/security/how-to-structure-a-pen-test-report/)
- [Rhino Security Labs：每份渗透测试报告应包含的四个要素](https://rhinosecuritylabs.com/penetration-testing/four-things-every-penetration-test-report/)
