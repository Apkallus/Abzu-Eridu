# 枚举基础设施与应用管理接口

## 总结

应用程序或应用服务器上可能存在管理员接口，允许特定用户执行站点特权操作。测试需验证未授权用户或普通用户能否访问该特权功能及其实现方式。

应用程序可能需要管理员接口，使特权用户能够访问以下功能：
- 用户账户配置
- 站点设计与布局
- 数据操作
- 配置变更

多数情况下，此类接口缺乏充分的访问控制保护机制。测试旨在发现这些管理员接口，并访问专为特权用户设计的功能。

## 测试目标
- 识别隐藏的管理员接口及功能

## 如何测试

### 黑盒测试

以下部分描述了可用于测试管理员接口是否存在的向量。这些技术也可用于测试相关安全问题（如权限提升），并在本指南其他章节（例如[测试绕过授权方案](../05-Authorization_Testing/02-Testing_for_Bypassing_Authorization_Schema.md)和[测试不安全的直接对象引用](../05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References.md)）中有更详细说明。

- 目录和文件枚举：管理员接口可能存在但对测试者不可见。可通过简单请求（如`/admin`或`/administrator`）猜测接口路径。某些情况下，使用高级Google搜索技术（如[Google dorks](https://www.exploit-db.com/google-hacking-database)）可在数秒内发现这些路径。现有多种工具可对服务器内容进行暴力枚举，详见后续工具章节。测试者可能还需识别管理页面的文件名，强制浏览已识别的页面可能会提供访问接口的途径。
- 源代码中的注释和链接：许多站点使用为所有用户加载的通用代码。通过检查发送至客户端的全部源代码，可能会发现管理员功能链接并需进一步调查。
- 审查服务器和应用程序文档：若应用服务器或应用程序以默认配置部署，可能通过配置文档或帮助文档中的信息访问管理接口。若发现需凭证的管理接口，应参考默认密码列表。
- 公开可用信息：许多应用程序（如WordPress）默认存在可访问的管理员接口。
- 备用服务器端口：管理接口可能位于主机上不同于主应用程序的端口。例如Apache Tomcat的管理接口常见于8080端口。
- 参数篡改：可能需要GET/POST参数或Cookie来启用管理员功能。线索包括隐藏字段的存在，例如：
  
    ```html
    <input type="hidden" name="admin" value="no">
    ```
  
    或Cookie中的：

    ```http
    Cookie: session_cookie; useradmin=0
    ```

发现管理员接口后，可结合上述技术尝试绕过认证。若失败，测试者可考虑暴力破解攻击，但需注意若存在账户锁定机制可能导致管理员账户被锁定。

### 灰盒测试

需对服务器和应用程序组件进行更详细的检查，以确保其已加固（例如，通过IP过滤或其他控制措施，管理员页面不会对所有人开放），并在适用情况下验证所有组件未使用默认凭证或配置。
应审查源代码以确保授权和认证模型能明确分离普通用户与站点管理员的职责。需审查普通用户和管理员共享的用户界面功能，确保此类组件的呈现以及共享功能的信息泄漏风险得到明确隔离。

每个Web框架可能有其默认的管理页面或路径，例如：

PHP:

```html
/phpinfo
/phpmyadmin/
/phpMyAdmin/
/mysqladmin/
/MySQLadmin
/MySQLAdmin
/login.php
/logon.php
/xmlrpc.php
/dbadmin
```

WordPress:

```html
wp-admin/
wp-admin/about.php
wp-admin/admin-ajax.php
wp-admin/admin-db.php
wp-admin/admin-footer.php
wp-admin/admin-functions.php
wp-admin/admin-header.php
```

Joomla:

```html
/administrator/index.php
/administrator/index.php?option=com_login
/administrator/index.php?option=com_content
/administrator/index.php?option=com_users
/administrator/index.php?option=com_menus
/administrator/index.php?option=com_installer
/administrator/index.php?option=com_config
```

Tomcat:

```html
/manager/html
/host-manager/html
/manager/text
/tomcat-users.xml
```

Apache:

```html
/index.html
/httpd.conf
/apache2.conf
/server-status
```

Nginx:

```html
/index.html
/index.htm
/index.php
/nginx_status
/index.php
/nginx.conf
/html/error
```

## 工具

多种工具可协助识别隐藏的管理员接口和功能，包括：
- [ZAP - 强制浏览](https://www.zaproxy.org/docs/desktop/addons/forced-browse/) 是OWASP原有DirBuster项目的当前维护版本。
- [THC-HYDRA](https://github.com/vanhauser-thc/thc-hydra) 支持对多种接口进行暴力破解，包括基于表单的HTTP认证。
- 使用优质字典（如[Netsparker字典](https://www.netsparker.com/blog/web-security/svn-digger-better-lists-for-forced-browsing/)）可显著提升暴力破解工具效率。

## 参考资料

- [WSTG-CONF-05](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/05-Enumerate_Infrastructure_and_Application_Admin_Interfaces.md)
- [Cirt：默认密码列表](https://cirt.net/passwords)
- [FuzzDB可用于暴力浏览管理员登录路径](https://github.com/fuzzdb-project/fuzzdb/blob/master/discovery/predictable-filepaths/login-file-locations/Logins.txt)
- [常见管理或调试参数](https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/business-logic/CommonDebugParamNames.txt)
