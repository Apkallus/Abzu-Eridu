# 测试文件权限

## 摘要

当资源被赋予超出必要范围的权限设置时，可能导致敏感信息泄露或资源被非预期方篡改。若资源涉及程序配置、执行或敏感用户数据，此类风险尤为危险。

典型示例如：可被未授权用户执行的程序文件。另一案例是用于访问API的账户信息或令牌值。在现代网络服务和微服务中，此类数据日益普遍，且可能存储在安装时默认具有全局可读权限的配置文件中。这些敏感数据既可能被主机系统内部的恶意主体窃取，也可能遭远程攻击者利用——后者可能通过其他漏洞入侵服务，仅获取普通用户权限即可实施攻击。

## 测试目标

- 审查并识别所有不当文件权限。


## 如何测试

在 Linux 系统中，使用 `ls` 命令检查文件权限。此外，也可使用 `namei` 命令递归列出文件权限。

`$ namei -l /待检查路径/`

需要进行文件权限测试的文件和目录包括但不限于以下类型：

- Web 文件/目录
- 配置文件/目录
- 敏感文件（加密数据、密码、密钥）/目录
- 日志文件（安全日志、操作日志、管理日志）/目录
- 可执行文件（脚本、EXE、JAR、class、PHP、ASP）/目录
- 数据库文件/目录
- 临时文件/目录
- 上传文件/目录

## 修复措施

正确设置文件和目录的权限，确保未授权用户无法访问关键资源。

## Tools

- [Windows AccessEnum](https://technet.microsoft.com/en-us/sysinternals/accessenum)
- [Windows AccessChk](https://technet.microsoft.com/en-us/sysinternals/accesschk)
- [Linux namei](https://linux.die.net/man/1/namei)

## References

- [WSTG-CONF-09](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission.md)
- [CWE-732: Incorrect Permission Assignment for Critical Resource](https://cwe.mitre.org/data/definitions/732.html)