---
id: 
title: Logging Security
---
<!-- muse start -->
Web Goat 对 logs 的简略介绍。
若对数据无处理则日志本身将应用载荷。以及日志对敏感信息的处理。
<!-- muse end -->

## 1. 概念

日志记录对现代系统至关重要。我们使用日志的目的包括：

- 应用监控与调试
- 审计日志：例如记录用户和系统的特定操作
- 安全事件监控：例如向SIEM（安全信息和事件管理）或SOAR（安全编排、自动化与响应）系统提供信息，这些系统将基于日志内容触发响应

## 2. 实践尝试

本挑战的目标是使日志中显示用户名"admin"成功登录。

下方红色区域内容将记录在Web服务器的日志文件中。

进阶挑战：尝试通过向日志文件注入脚本来升级攻击。

日志将记录数据作为 HTML 代码执行
`admin<script>alert(1)</script>`

## 3. 关于日志记录的更多内容

正如目前所见，当用户尝试伪造日志时，日志伪造可能成为安全问题。除了表单提交外，还存在多种实现方式（例如URL参数或精心构造的JSON载荷）。因此需要确保：

- 实施适当的输入净化
- 建立来源真实性验证并实施完整性控制以检测日志篡改
- 确保用户无法通过任何通道注入日志
- 保障日志存储的安全性

但日志安全不仅限于防范伪造攻击的净化措施。下面我们关注敏感信息的日志记录问题。

### 敏感信息记录

在前述练习中，我们仅看到用户名被记录而未涉及密码。这是因为需要确保应用日志不包含任何敏感信息。当日志泄露时，应避免认证信息被恶意复用。

同理，不应记录其他敏感信息（如对称密钥/私钥、访问令牌等）。

### 个人信息的记录

需谨慎处理个人信息日志。例如：
- 不记录银行账户详情
- 未经用户同意不记录个人身份信息
- 不记录可识别被日志主体身份的数据

核心目标是防止他人通过日志构建用户画像或实施监控，保障系统使用者的隐私权。

### 特殊案例：访问日志

入口网关和/或应用服务器提供的访问日志需至少包含：
- 请求来源
- 请求时间
- 可选的响应状态码

根据日志安全性可添加其他信息，但应注意：
- 避免在访问日志中记录原始请求以保护用户隐私
- 常见问题：访问日志可能捕获包含敏感参数的完整URL
- 解决方案：谨慎设置URL参数，确保开放访问日志不记录敏感参数

### 扩展阅读

如需深入了解日志记录，请参考：
- [OWASP日志记录备忘单](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)
- [维基百科GDPR条款](https://en.wikipedia.org/wiki/General_Data_Protection_Regulation#Principles)


## 4. 实践尝试

部分服务器在启动时会提供`Administrator`凭据。

本挑战目标是在WebGoat服务器的应用日志中查找密钥，以便以 `Admin` 身份登录。

请注意我们尝试对其进行了"保护"。您能否解码它？

如题目所述，在 Web Goat 的 docker 终端日志中搜索关键词 `amdin`，得到
```log
2026-01-05T17:21:51.306+08:00  INFO 1 --- [           main] o.o.w.lessons.logging.LogBleedingTask    : Password for admin: NWFkNGRmNGMtMzdmOC00OGRhLWI1YTUtMGZhNDcwMjNiNjIz
```
Base 64解码后得到
`5ad4df4c-37f8-48da-b5a5-0fa47023b623`

此处需使用用户名 `Admin`

## 5. 关于日志记录的深入探讨（第二部分）

现在应当明确，使用简单编码/解码并不能有效保护日志中的敏感信息。更好的技术方案包括：完全不记录数据、对数据进行脱敏处理，或使用共享密钥进行加密。

还需探讨以下几个主题：
- 日志级别的运用
- 异常处理方法
- 日志记录的其他应用场景
- 相关扩展阅读资源

### 日志级别

阐述不同日志级别的定义与应用场景

### 异常处理

异常处理（可举例说明向客户端记录加密相关异常的错误做法及其风险）

### 审计日志、安全事件监控与应用日志

需注意日志记录不仅用于应用调试。应用日志常作为数据源用于以下场景：

- 审计日志：应用日志需记录特定事件以构建可追溯的操作轨迹，用于重构用户相关操作。例如在司法争议中可作为事件证据。

- 安全事件监控（SEM）：安全部门可通过应用生成的事件分析组织内应用态势。不同类型事件及其属性可用于风险检测，例如：
    - 仅作为应急措施使用的特权管理员登录行为即具有重要监控价值
    - 频繁的管理员登录虽需记录，但通常不会直接触发安全警报，除非登录位置出现异常
    与安全部门开展威胁建模演练，可明确所需日志类型及即时告警规则。

- 欺诈检测：应用日志有助于识别欺诈行为。例如：日志显示用户尝试转移超出其持有金额的资金时，可能预示异常活动。

- 业务流程监控：通过日志可观察业务流程运行状态。例如：流程下游长时间缺乏新事件可能表明业务进程停滞，这对企业运营决策具有重要价值。

- （此外还存在许多其他应用场景...）

需要注意的是，不同日志用途存在显著差异！因此建议在日志输出、存储和组织内处理时，将应用调试日志与SEM日志、审计日志进行分离。

### 扩展阅读
- [OWASP日志记录备忘单](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)
